import{a as L}from"./chunk-OMOZFGPK.js";import{b as Oe,c as Ve}from"./chunk-UDCF3VBL.js";import{a as Re}from"./chunk-QPHLC2XJ.js";import{a as xe}from"./chunk-AEHS2M37.js";import{A as S,Ad as Te,Ca as _e,Cd as We,Db as w,Ea as E,Fa as M,Fb as ee,Ga as g,Ha as s,I as me,Ia as l,Ja as D,K as de,Ka as V,La as G,M as U,O as d,Pb as we,Q as h,Qa as P,R as u,Rb as T,S as pe,Sa as f,Ta as ke,Td as Fe,Ua as y,Ud as Be,V as he,Yd as He,Z as b,Zd as Ae,_c as Me,a as O,ab as be,b as ae,bb as ge,be as Ne,cb as I,d as se,db as ve,ea as a,eb as p,ed as De,ee as j,fd as x,fe as $,gb as N,gd as te,ge as z,h as le,hb as m,ib as Z,jb as v,ka as ue,kb as Ce,la as _,qa as fe,ra as ye,sb as k,tb as C,ua as B,ub as J,uc as Se,v as ce,w as F,wc as Ee,ya as H,za as A,zb as R,zd as Ie}from"./chunk-ZDVCRLK2.js";var W=se(xe());function Ke(o,i){}var Pe="_mat-bottom-sheet-enter",Le="_mat-bottom-sheet-exit",Qe=(()=>{class o extends Oe{_breakpointSubscription;_animationsDisabled=te();_animationState="void";_animationStateChanged=new he;_destroyed=!1;constructor(){super();let e=d(Me);this._breakpointSubscription=e.observe([x.Medium,x.Large,x.XLarge]).subscribe(()=>{let t=this._elementRef.nativeElement.classList;t.toggle("mat-bottom-sheet-container-medium",e.isMatched(x.Medium)),t.toggle("mat-bottom-sheet-container-large",e.isMatched(x.Large)),t.toggle("mat-bottom-sheet-container-xlarge",e.isMatched(x.XLarge))})}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._animationsDisabled&&this._simulateAnimation(Pe))}exit(){this._destroyed||(this._elementRef.nativeElement.setAttribute("mat-exit",""),this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._animationsDisabled&&this._simulateAnimation(Le))}ngOnDestroy(){super.ngOnDestroy(),this._breakpointSubscription.unsubscribe(),this._destroyed=!0}_simulateAnimation(e){this._ngZone.run(()=>{this._handleAnimationEvent(!0,e),setTimeout(()=>this._handleAnimationEvent(!1,e))})}_trapFocus(){super._trapFocus({preventScroll:!0})}_handleAnimationEvent(e,t){let n=t===Pe;(n||t===Le)&&this._animationStateChanged.emit({toState:n?"visible":"hidden",phase:e?"start":"done"})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=_({type:o,selectors:[["mat-bottom-sheet-container"]],hostAttrs:["tabindex","-1",1,"mat-bottom-sheet-container"],hostVars:9,hostBindings:function(t,n){t&1&&f("animationstart",function(c){return n._handleAnimationEvent(!0,c.animationName)})("animationend",function(c){return n._handleAnimationEvent(!1,c.animationName)})("animationcancel",function(c){return n._handleAnimationEvent(!1,c.animationName)}),t&2&&(B("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-label",n._config.ariaLabel),p("mat-bottom-sheet-container-animations-enabled",!n._animationsDisabled)("mat-bottom-sheet-container-enter",n._animationState==="visible")("mat-bottom-sheet-container-exit",n._animationState==="hidden"))},features:[fe],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,n){t&1&&ye(0,Ke,0,0,"ng-template",0)},dependencies:[He],styles:[`@keyframes _mat-bottom-sheet-enter{from{transform:translateY(100%)}to{transform:none}}@keyframes _mat-bottom-sheet-exit{from{transform:none}to{transform:translateY(100%)}}.mat-bottom-sheet-container{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);padding:8px 16px;min-width:100vw;box-sizing:border-box;display:block;outline:0;max-height:80vh;overflow:auto;position:relative;background:var(--mat-bottom-sheet-container-background-color, var(--mat-sys-surface-container-low));color:var(--mat-bottom-sheet-container-text-color, var(--mat-sys-on-surface));font-family:var(--mat-bottom-sheet-container-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-bottom-sheet-container-text-size, var(--mat-sys-body-large-size));line-height:var(--mat-bottom-sheet-container-text-line-height, var(--mat-sys-body-large-line-height));font-weight:var(--mat-bottom-sheet-container-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-bottom-sheet-container-text-tracking, var(--mat-sys-body-large-tracking))}@media(forced-colors: active){.mat-bottom-sheet-container{outline:1px solid}}.mat-bottom-sheet-container-animations-enabled{transform:translateY(100%)}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-enter{animation:_mat-bottom-sheet-enter 195ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-exit{animation:_mat-bottom-sheet-exit 375ms cubic-bezier(0.4, 0, 1, 1) backwards}.mat-bottom-sheet-container-xlarge,.mat-bottom-sheet-container-large,.mat-bottom-sheet-container-medium{border-top-left-radius:var(--mat-bottom-sheet-container-shape, 28px);border-top-right-radius:var(--mat-bottom-sheet-container-shape, 28px)}.mat-bottom-sheet-container-medium{min-width:384px;max-width:calc(100vw - 128px)}.mat-bottom-sheet-container-large{min-width:512px;max-width:calc(100vw - 256px)}.mat-bottom-sheet-container-xlarge{min-width:576px;max-width:calc(100vw - 384px)}
`],encapsulation:2})}return o})(),ie=new U("MatBottomSheetData"),ne=class{viewContainerRef;injector;panelClass;direction;data=null;hasBackdrop=!0;backdropClass;disableClose=!1;ariaLabel=null;ariaModal=!1;closeOnNavigation=!0;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;height="";minHeight;maxHeight},q=class{_ref;get instance(){return this._ref.componentInstance}get componentRef(){return this._ref.componentRef}containerInstance;disableClose;_afterOpened=new le;_result;_closeFallbackTimeout;constructor(i,e,t){this._ref=i,this.containerInstance=t,this.disableClose=e.disableClose,t._animationStateChanged.pipe(F(n=>n.phase==="done"&&n.toState==="visible"),S(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(F(n=>n.phase==="done"&&n.toState==="hidden"),S(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._ref.close(this._result)}),i.overlayRef.detachments().subscribe(()=>{this._ref.close(this._result)}),ce(this.backdropClick(),this.keydownEvents().pipe(F(n=>n.keyCode===27))).subscribe(n=>{!this.disableClose&&(n.type!=="keydown"||!De(n))&&(n.preventDefault(),this.dismiss())})}dismiss(i){this.containerInstance&&(this.containerInstance._animationStateChanged.pipe(F(e=>e.phase==="start"),S(1)).subscribe(()=>{this._closeFallbackTimeout=setTimeout(()=>this._ref.close(this._result),500),this._ref.overlayRef.detachBackdrop()}),this._result=i,this.containerInstance.exit(),this.containerInstance=null)}afterDismissed(){return this._ref.closed}afterOpened(){return this._afterOpened}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}},Xe=new U("mat-bottom-sheet-default-options"),je=(()=>{class o{_injector=d(pe);_parentBottomSheet=d(o,{optional:!0,skipSelf:!0});_animationsDisabled=te();_defaultOptions=d(Xe,{optional:!0});_bottomSheetRefAtThisLevel=null;_dialog=d(Ve);get _openedBottomSheetRef(){let e=this._parentBottomSheet;return e?e._openedBottomSheetRef:this._bottomSheetRefAtThisLevel}set _openedBottomSheetRef(e){this._parentBottomSheet?this._parentBottomSheet._openedBottomSheetRef=e:this._bottomSheetRefAtThisLevel=e}constructor(){}open(e,t){let n=O(O({},this._defaultOptions||new ne),t),r;return this._dialog.open(e,ae(O({},n),{disableClose:!0,closeOnOverlayDetachments:!1,maxWidth:"100%",container:Qe,scrollStrategy:n.scrollStrategy||Ae(this._injector),positionStrategy:Ne(this._injector).centerHorizontally().bottom("0"),disableAnimations:this._animationsDisabled,templateContext:()=>({bottomSheetRef:r}),providers:(c,ot,ze)=>(r=new q(c,n,ze),[{provide:q,useValue:r},{provide:ie,useValue:n.data}])})),r.afterDismissed().subscribe(()=>{this._openedBottomSheetRef===r&&(this._openedBottomSheetRef=null)}),this._openedBottomSheetRef?(this._openedBottomSheetRef.afterDismissed().subscribe(()=>r.containerInstance?.enter()),this._openedBottomSheetRef.dismiss()):r.containerInstance.enter(),this._openedBottomSheetRef=r,r}dismiss(e){this._openedBottomSheetRef&&this._openedBottomSheetRef.dismiss(e)}ngOnDestroy(){this._bottomSheetRefAtThisLevel&&this._bottomSheetRefAtThisLevel.dismiss()}static \u0275fac=function(t){return new(t||o)};static \u0275prov=de({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Ye=["noteInput"],Ue=["valueInput"],Ge=(o,i)=>i.id;function Ze(o,i){if(o&1){let e=P();s(0,"div",8)(1,"span",9),f("click",function(){let n=h(e).$implicit,r=y();return u(r.edit(n,"note"))}),m(2),l(),s(3,"span",10),f("click",function(){let n=h(e).$implicit,r=y();return u(r.edit(n,"value"))}),m(4),k(5,"currency"),l(),s(6,"input",11,0),f("click",function(){h(e);let n=I(7);return u(n.select())})("blur",function(){h(e);let n=y();return u(n.submit())})("keyup.enter",function(){h(e);let n=y();return n.submit(),u(n.reset())}),l(),H(),s(8,"input",12,1),f("click",function(){h(e);let n=I(9);return u(n.select())})("blur",function(){h(e);let n=y();return u(n.submit())})("keyup.enter",function(){h(e);let n=y();return n.submit(),u(n.reset())}),l(),H(),s(10,"button",13),f("click",function(){let n=h(e).$implicit,r=y();return u(r.deleteEntry(n.id))}),l()()}if(o&2){let e=i.$implicit,t=i.$index,n=i.$count,r=y(),c="ml-2 my-2 p-4";p("border-b-gray-50",t!==n-1)("border-b",t!==n-1),a(),N(c),p("hidden",r.selectedEntry()===e.id),a(),v(" ",e.note," "),a(),N(c),p("hidden",r.selectedEntry()===e.id),a(),v(" ",C(5,28,e.value)," "),a(2),N(c),p("hidden",r.selectedEntry()!==e.id),B("data-id",e.id),A(r.form.note,"formField"),a(2),N(c),p("hidden",r.selectedEntry()!==e.id),B("data-id",e.id),A(r.form.value,"formField")}}function Je(o,i){o&1&&(s(0,"div",6),m(1,"Noch keine Eintr\xE4ge vorhanden."),l())}var Q=class o{facade=d(L);history=this.facade.currentHistory;data=d(ie);noteInputs=ee("noteInput");valueInputs=ee("valueInput");selectedEntry=b(null);formModel=b(this.initForm());form=j(this.formModel,i=>{z(i.id),z(i.value),z(i.note)});constructor(){this.facade.setCurrentHistoryInformation(this.data.weeklyCheckId,this.data.shop)}deleteEntry(i){return this.facade.deleteHistoryEntry(i)}addEntry(){this.facade.addHistoryEntry()}edit(i,e){this.selectedEntry.set(i.id),this.formModel.set({id:i.id,value:i.value,note:i.note}),setTimeout(()=>{let t=this.selectedEntry();if(t)switch(e){case"note":{this.noteInputs().find(r=>r.nativeElement.dataset.id===t).nativeElement.select();break}case"value":{this.valueInputs().find(r=>r.nativeElement.dataset.id===t).nativeElement.select();break}}})}submit(){this.form().valid()&&this.facade.updateHistoryEntry(this.formModel())}reset(){this.selectedEntry.set(null),this.formModel.set(this.initForm())}initForm(){return{id:null,value:null,note:null}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=_({type:o,selectors:[["app-weekly-history"]],viewQuery:function(e,t){e&1&&be(t.noteInputs,Ye,5)(t.valueInputs,Ue,5),e&2&&ge(2)},decls:8,vars:1,consts:[["noteInput",""],["valueInput",""],[1,"flex","flex-col","gap-2","overflow-hidden","pb-2"],[1,"max-h-64","overflow-auto"],[1,"flex","w-full","flex-col","items-center","justify-center","**:text-white"],[1,"grid","w-full","grid-cols-[auto_6rem_min-content]","items-center","gap-2",3,"border-b-gray-50","border-b"],[1,"p-2"],["maffiButton","","icon","CirclePlus",1,"self-center",3,"click"],[1,"grid","w-full","grid-cols-[auto_6rem_min-content]","items-center","gap-2"],[3,"click"],[1,"m-0!","my-0!","w-full","text-right",3,"click"],[1,"w-full","rounded","border","border-blue-400","bg-gray-600","outline-none",3,"click","blur","keyup.enter","formField"],["type","number",1,"w-full","rounded","border","border-blue-400","bg-gray-600","text-right","outline-none",3,"click","blur","keyup.enter","formField"],["maffiButton","","icon","Trash",1,"mr-2",3,"click"]],template:function(e,t){e&1&&(s(0,"section",2)(1,"div",3)(2,"div",4),E(3,Ze,11,30,"div",5,Ge,!1,Je,2,0,"div",6),l()(),s(6,"button",7),f("click",function(){return t.addEntry()}),m(7," Hinzuf\xFCgen "),l()()),e&2&&(a(3),M(t.history()))},dependencies:[Ie,$,T],encapsulation:2})};var X=class o{bottomSheet=d(je);viewContainerRef=d(ue);weeklyCheckId=w.required();label=w.required();entry=w.required();shop=w.required();isOpened=b(!1);openBottomSheet(){this.isOpened.set(!0);let i={weeklyCheckId:this.weeklyCheckId(),shop:this.shop()};this.bottomSheet.open(Q,{data:i,viewContainerRef:this.viewContainerRef}).afterDismissed().pipe(S(1),me(()=>this.isOpened.set(!1))).subscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=_({type:o,selectors:[["app-weekly-check-shop"]],inputs:{weeklyCheckId:[1,"weeklyCheckId"],label:[1,"label"],entry:[1,"entry"],shop:[1,"shop"]},decls:6,vars:8,consts:[[1,"flex","cursor-pointer","flex-col","gap-1","rounded-lg","p-1","hover:bg-gray-600","focus:bg-gray-600",3,"click"],[1,"text-xs","whitespace-nowrap"],[1,"text-sm"]],template:function(e,t){e&1&&(V(0,"div",0),ke("click",function(){return t.openBottomSheet()}),V(1,"span",1),m(2),G(),V(3,"span",2),m(4),k(5,"currency"),G()()),e&2&&(p("bg-gray-600",t.isOpened())("bg-gray-700",!t.isOpened()),a(2),Z(t.label()),a(2),Z(C(5,6,t.entry().value)))},dependencies:[T],encapsulation:2})};function et(o,i){if(o&1&&D(0,"app-weekly-check-shop",11),o&2){let e=i.$implicit,t=y();g("weeklyCheckId",t.week().id)("label",e.label)("entry",e.entry)("shop",e.shop)}}var Y=class o{week=w.required();entries=R(()=>{let i=this.week();return[{label:"Lidl",entry:i.lidl,shop:"lidl"},{label:"Drogerie",entry:i.drugstore,shop:"drugstore"},{label:"Edeka",entry:i.edeka,shop:"edeka"},{label:"Sonstige",entry:i.misc,shop:"misc"},{label:"Kaufland",entry:i.kaufland,shop:"kaufland"},{label:"B\xE4cker / Fleischer",entry:i.baker_butcher,shop:"baker_butcher"},{label:"Ausw\xE4rts",entry:i.away,shop:"away"}]});isExpanded=R(()=>{let i=this.week(),e=(0,W.default)();return(0,W.default)(i.dateFrom).isSame(e,"day")||(0,W.default)(i.dateTo).isSame(e,"day")||(0,W.default)(i.dateFrom).isBefore(e,"day")&&(0,W.default)(i.dateTo).isAfter(e,"day")});static \u0275fac=function(e){return new(e||o)};static \u0275cmp=_({type:o,selectors:[["app-week"]],inputs:{week:[1,"week"]},decls:25,vars:27,consts:[["accItem","cdkAccordionItem"],[3,"expanded"],[1,"grid","w-full","grid-cols-[5rem_1fr_1.5rem]","gap-2",3,"click"],[1,"flex","items-center","gap-4"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],[1,"text-(length:--text-xs)","font-medium"],[1,"text-right"],["size","small",1,"ml-1",3,"icon"],[1,"overflow-hidden","pt-4","transition-[max-height]","duration-300","ease-in-out"],[1,"grid","grid-cols-3","gap-2"],[3,"weeklyCheckId","label","entry","shop"]],template:function(e,t){if(e&1){let n=P();s(0,"mat-card")(1,"mat-card-content")(2,"cdk-accordion-item",1,0)(4,"header",2),f("click",function(){h(n);let c=I(3);return u(c.toggle())}),s(5,"div",3)(6,"div",4)(7,"h2",5),m(8),l(),s(9,"h1",6),m(10),k(11,"date"),k(12,"date"),l()()(),s(13,"div",4)(14,"span",7),m(15),k(16,"currency"),l(),s(17,"span",7),m(18),k(19,"currency"),l()(),D(20,"app-icon",8),l(),s(21,"div",9)(22,"div",10),E(23,et,1,4,"app-weekly-check-shop",11,_e),l()()()()()}if(e&2){let n=I(3);a(2),g("expanded",t.isExpanded()),a(6),v("KW ",t.week().cw),a(2),Ce(" ",J(11,17,t.week().dateFrom,"dd.MM.")," - ",J(12,20,t.week().dateTo,"dd.MM.")," ");let r=t.week().total,c=250-r;a(4),p("text-green-500",r<=250)("text-red-500",r>250),a(),v(" ",C(16,23,r)," "),a(2),p("text-green-500",r<=250)("text-red-500",r>250),a(),v(" ",C(19,25,c)," "),a(2),g("icon",n.expanded?"ChevronUp":"ChevronDown"),a(),ve("max-height",n.expanded?"1000px":"0px"),a(2),M(t.entries())}},dependencies:[Se,Ee,Be,Te,X,we,T],encapsulation:2})};var re=se(xe());var tt=(o,i)=>i.id;function nt(o,i){if(o&1&&D(0,"app-week",3),o&2){let e=i.$implicit;g("week",e)}}function it(o,i){o&1&&m(0," Noch keine Wochen angelegt ")}var $e=class o{facade=d(L);weeks=this.facade.weeklyChecks;isLoading=this.facade.isLoading;formModel=b({month:(0,re.default)().format("MMMM")});form=j(this.formModel);filteredWeeks=R(()=>this.weeks().filter(i=>i.month===this.formModel().month));constructor(){this.facade.loadWeeklyChecks()}months=Array.from({length:12},(i,e)=>(0,re.default)().month(e).format("MMMM"));static \u0275fac=function(e){return new(e||o)};static \u0275cmp=_({type:o,selectors:[["app-weekly-check"]],decls:6,vars:5,consts:[["title","Wochencheck"],[1,"w-40",3,"items","clearable","formField"],[1,"container-max-sm","mt-2","flex","w-full","flex-col","items-center","gap-2","p-2","*:w-full","md:p-6"],[3,"week"]],template:function(e,t){e&1&&(s(0,"app-header",0),D(1,"ng-select",1),H(),l(),s(2,"cdk-accordion",2),E(3,nt,1,1,"app-week",3,tt,!1,it,1,0),l()),e&2&&(a(),g("items",t.months)("clearable",!1),A(t.form.month,"formField"),a(2),M(t.filteredWeeks()))},dependencies:[We,Y,Fe,Re,$],encapsulation:2})};export{$e as WeeklyCheckComponent};
