import{a as u,c as A}from"./chunk-G2IWVXPG.js";import{a as re,b as le}from"./chunk-AMQZX7XM.js";import"./chunk-LRANXSOB.js";import{c as I}from"./chunk-ITOCBLQG.js";import{a as Z}from"./chunk-TKYGLH5L.js";import{Aa as R,Ad as ne,Ba as T,Cc as ee,Cd as ae,Eb as j,Fc as te,Ga as r,Ha as d,Hc as oe,Ia as s,Ja as h,Mc as w,O as l,Q as _,Qa as M,R as C,Rd as ie,Sa as m,Sd as D,Td as se,Ua as c,Z as $,a as Y,ab as z,b as k,bb as G,cb as Q,d as q,ea as b,hb as F,he as f,ib as J,ie as de,la as p,nb as K,oa as H,ra as U,sb as O,tb as W,vb as X,zb as S}from"./chunk-ERYDUTZI.js";var V=class i{facade=l(u);fixedCosts=this.facade.fixedCosts;isLoading=this.facade.isLoading;isSaving=this.facade.isSaving;isAdded=this.facade.isFixedAdded;total=this.facade.totalFixedCosts;constructor(){this.facade.loadFixedCosts()}addFixedCost(){this.facade.add({category:"Neu",value:0,due_in:"Alle",type:"Fix"})}updateFixedCost(o){this.facade.update(o)}deleteFixedCost(o){this.facade.delete(o,"Alle","Fix")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-fixed-costs-table"]],decls:1,vars:5,consts:[["headerTitle","Fixkosten","headerIcon","BanknoteArrowDown",3,"addRow","updateRow","deleteRow","data","total","isLoading","isAdded","isSaving"]],template:function(e,t){e&1&&(d(0,"app-money-table-v2",0),m("addRow",function(){return t.addFixedCost()})("updateRow",function(n){return t.updateFixedCost(n)})("deleteRow",function(n){return t.deleteFixedCost(n)}),s()),e&2&&r("data",t.fixedCosts())("total",t.total())("isLoading",t.isLoading())("isAdded",t.isAdded())("isSaving",!1)},dependencies:[D,w,f],encapsulation:2})};var B=class i{facade=l(u);quarterlyCosts=this.facade.quarterlyCosts;total=this.facade.totalQuarterlyCosts;isLoading=this.facade.isLoading;isAdded=this.facade.isQuarterlyAdded;add(){this.facade.add({category:"Neu",value:0,due_in:"Quartal",type:"Fix"})}update(o){this.facade.update(o)}delete(o){this.facade.delete(o,"Quartal","Fix")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-quarterly-costs"]],decls:1,vars:5,consts:[["headerTitle","Quartalskosten","headerIcon","BanknoteArrowDown",3,"addRow","updateRow","deleteRow","data","total","isLoading","isSaving","isAdded"]],template:function(e,t){e&1&&(d(0,"app-money-table-v2",0),m("addRow",function(){return t.add()})("updateRow",function(n){return t.update(n)})("deleteRow",function(n){return t.delete(n)}),s()),e&2&&r("data",t.quarterlyCosts())("total",t.total())("isLoading",t.isLoading())("isSaving",!1)("isAdded",t.isAdded())},dependencies:[f],encapsulation:2})};var g=q(Z());var pe=q(Z());var N=class i{transform(o){return!o||o.length===0?null:o.map(e=>(0,pe.default)(e).format("MMMM")).join(", ")}static \u0275fac=function(e){return new(e||i)};static \u0275pipe=H({name:"toMonth",type:i,pure:!0})};var ce=["dueInMonth"],ue=()=>["above","before"];function fe(i,o){if(i&1){let e=M();d(0,"ng-select",5),m("change",function(){_(e);let a=c().$implicit,n=c();return C(n.addValue(a))})("remove",function(a){_(e);let n=c().$implicit,v=c();return C(v.removeValue(n,a))})("close",function(){_(e);let a=c(2);return C(a.selectedRow.set(null))}),s()}if(i&2){let e=c(2);r("items",e.months)("formControl",e.dueInMonthControl)("clearable",!1)("multiple",!0)("appendTo","body")}}function _e(i,o){if(i&1){let e=M();d(0,"app-icon",6),m("click",function(){_(e);let a=c().$implicit,n=c();return C(n.selectRow(a.id,a.due_in_month))}),s(),d(1,"mtx-popover",7,1)(3,"span"),F(4),O(5,"toMonth"),s()()}if(i&2){let e=Q(2),t=c().$implicit;r("mtxPopoverTriggerFor",e),b(),r("position",K(5,ue)),b(3),J(W(5,3,t.due_in_month))}}function Ce(i,o){if(i&1&&(d(0,"div",3),R(1,fe,1,5,"ng-select",4)(2,_e,6,6),s()),i&2){let e=o.$implicit,t=c();b(),T(t.selectedRow()===e.id?1:2)}}var L=class i{facade=l(u);specialCosts=this.facade.specialCosts;total=this.facade.totalSpecialCosts;isLoading=this.facade.isLoading;isAdded=this.facade.isSpecialAdded;dueInMonthsTmp=j.required("dueInMonth");selectTmpRef=j(I);selectedRow=$(null);additionalColumns=S(()=>[{name:"due_in_month",template:this.dueInMonthsTmp()}]);dueInMonthControl=new te([],{nonNullable:!0});months=Array.from({length:12},(o,e)=>{let t=(0,g.default)().month(e);return{label:t.format("MMMM"),value:t.format("YYYY-MM-DD")}});selectRow(o,e){this.selectedRow.set(o);let a=(e??[]).map(n=>({label:(0,g.default)(n).format("MMMM"),value:n}));this.dueInMonthControl.setValue(a),setTimeout(()=>this.selectTmpRef()?.open())}add(){this.facade.add({category:"Neu",value:0,due_in:"Sonder",type:"Fix"})}addValue(o){let e=o.due_in_month??[];e=e.map(n=>(0,g.default)(n).format("YYYY-MM"));let t=this.dueInMonthControl.value.map(n=>(0,g.default)(n.value).format("YYYY-MM"));e=Array.from(new Set([...e,...t])),e=e.map(n=>(0,g.default)(n).format("YYYY-MM-DD"));let a=k(Y({},o),{due_in_month:e});a.due_in_month=Array.from(new Set(a.due_in_month)),this.facade.update(a),this.selectedRow.set(null),this.dueInMonthControl.setValue(null)}removeValue(o,e){let a=(o.due_in_month??[]).filter(v=>(0,g.default)(v).month()!==(0,g.default)(e.value).month()),n=k(Y({},o),{due_in_month:a});this.facade.update(n)}delete(o){this.facade.delete(o,"Sonder","Fix")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-special-costs"]],viewQuery:function(e,t){e&1&&z(t.dueInMonthsTmp,ce,5)(t.selectTmpRef,I,5),e&2&&G(2)},decls:3,vars:6,consts:[["dueInMonth",""],["popover",""],["headerTitle","Sonderkosten","headerIcon","BanknoteArrowDown",3,"addRow","updateRow","deleteRow","data","total","isLoading","isSaving","isAdded","col3Template"],[1,"flex","h-5","overflow-visible"],["bindLabel","label",1,"w-2/3",3,"items","formControl","clearable","multiple","appendTo"],["bindLabel","label",1,"w-2/3",3,"change","remove","close","items","formControl","clearable","multiple","appendTo"],["icon","Info",1,"block","h-5","w-24","flex-auto","pl-3",3,"click","mtxPopoverTriggerFor"],[3,"position"]],template:function(e,t){if(e&1){let a=M();d(0,"app-money-table-v2",2),m("addRow",function(){return _(a),C(t.add())})("updateRow",function(v){return _(a),C(t.addValue(v))})("deleteRow",function(v){return _(a),C(t.delete(v))}),s(),U(1,Ce,3,1,"ng-template",null,0,X)}if(e&2){let a=Q(2);r("data",t.specialCosts())("total",t.total())("isLoading",t.isLoading())("isSaving",!1)("isAdded",t.isAdded())("col3Template",a)}},dependencies:[I,w,ee,oe,f,ne,re,le,N],encapsulation:2})};var P=class i{facade=l(u);budgets=this.facade.budgets;total=this.facade.totalBudgets;isLoading=this.facade.isLoading;isSaving=this.facade.isSaving;isAdded=this.facade.isFixedAdded;add(){this.facade.add({category:"Neu",value:0,due_in:"Alle",type:"Budget"})}update(o){this.facade.update(o)}delete(o){this.facade.delete(o,"Alle","Budget")}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-budgets"]],decls:1,vars:5,consts:[["headerTitle","Budgets","headerIcon","BanknoteArrowDown",3,"addRow","updateRow","deleteRow","data","total","isLoading","isAdded","isSaving"]],template:function(e,t){e&1&&(d(0,"app-money-table-v2",0),m("addRow",function(){return t.add()})("updateRow",function(n){return t.update(n)})("deleteRow",function(n){return t.delete(n)}),s()),e&2&&r("data",t.budgets())("total",t.total())("isLoading",t.isLoading())("isAdded",t.isAdded())("isSaving",!1)},dependencies:[f],encapsulation:2})};var E=class i{facade=l(A);revenue=this.facade.revenue;total=this.facade.total;isLoading=this.facade.isLoading;isSaving=this.facade.isSaving;isAdded=this.facade.isAdded;constructor(){this.facade.loadRevenue()}addRevenue(){this.facade.addRevenue({category:"",value:0})}updateRevenue(o){this.facade.updateRevenue(o)}deleteRevenue(o){this.facade.deleteRevenue(o)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-revenue-base-table"]],decls:1,vars:5,consts:[["headerTitle","Einnahmen","headerIcon","BanknoteArrowUp",3,"addRow","updateRow","deleteRow","data","total","isLoading","isSaving","isAdded"]],template:function(e,t){e&1&&(d(0,"app-money-table-v2",0),m("addRow",function(){return t.addRevenue()})("updateRow",function(n){return t.updateRevenue(n)})("deleteRow",function(n){return t.deleteRevenue(n)}),s()),e&2&&r("data",t.revenue())("total",t.total())("isLoading",t.isLoading())("isSaving",t.isSaving())("isAdded",t.isAdded())},dependencies:[D,w,f],encapsulation:2})};function ge(i,o){i&1&&h(0,"mat-spinner",5)}var me=class i{fixedCostsFacade=l(u);revenueFacade=l(A);balance=S(()=>this.revenueFacade.total()-this.fixedCostsFacade.totalFixedCosts());isSavingCosts=this.fixedCostsFacade.isSaving;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=p({type:i,selectors:[["app-base"]],decls:13,vars:2,consts:[["title","Einnahmen & Ausgaben"],[1,"container-max-sm","mt-2","flex","flex-col","gap-4","p-2","md:p-6"],[1,"flex","flex-col","gap-4"],[1,"flex","items-center","gap-1"],[1,"pl-2","text-xl","font-semibold"],["diameter","18"],[3,"balance"]],template:function(e,t){e&1&&(h(0,"app-header",0),d(1,"section",1)(2,"cdk-accordion",2),h(3,"app-revenue-base-table"),d(4,"header",3)(5,"h1",4),F(6,"Ausgaben"),s(),R(7,ge,1,0,"mat-spinner",5),s(),h(8,"app-fixed-costs-table")(9,"app-budgets")(10,"app-quarterly-costs")(11,"app-special-costs"),s(),h(12,"app-balance",6),s()),e&2&&(b(7),T(t.isSavingCosts()?7:-1),b(5),r("balance",t.balance()))},dependencies:[E,ae,se,V,de,P,B,ie,L],encapsulation:2})};export{me as BaseComponent};
