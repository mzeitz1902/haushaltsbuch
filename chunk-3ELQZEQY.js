import{a as $}from"./chunk-BDWV27QP.js";import{F as C,J as _,N as g,Sb as R,Xb as M,Yb as f,Zb as d,_b as E,a as v,ac as H,b as y,bc as P,cc as k,d as O,dc as w,ec as I,fc as c,gc as h,l,q as p,ub as u}from"./chunk-7DKHPSUB.js";var r=H({source:"Monthly Check",events:{create:void 0,createSuccess:void 0,createFailure:void 0,getMonth:void 0,getMonthSuccess:void 0,getMonthFailure:void 0,getCreatedMonths:void 0,getCreatedMonthsSuccess:void 0,getCreatedMonthsFailure:void 0,addRevenue:void 0,addRevenueSuccess:void 0,addRevenueFailure:void 0,updateRevenue:void 0,updateRevenueSuccess:void 0,updateRevenueFailure:void 0,deleteRevenue:void 0,deleteRevenueSuccess:void 0,deleteRevenueFailure:void 0,addFixedCost:void 0,addFixedCostSuccess:void 0,addFixedCostFailure:void 0,updateFixedCost:void 0,updateFixedCostSuccess:void 0,updateFixedCostFailure:void 0,deleteFixedCost:void 0,deleteFixedCostSuccess:void 0,deleteFixedCostFailure:void 0,addVariableCost:void 0,addVariableCostSuccess:void 0,addVariableCostFailure:void 0,updateVariableCost:void 0,updateVariableCostSuccess:void 0,updateVariableCostFailure:void 0,deleteVariableCost:void 0,deleteVariableCostSuccess:void 0,deleteVariableCostFailure:void 0,addVariableCostHistoryEntry:void 0,addVariableCostHistoryEntrySuccess:void 0,addVariableCostHistoryEntryFailure:void 0,removeVariableCostHistoryEntry:void 0,removeVariableCostHistoryEntrySuccess:void 0,removeVariableCostHistoryEntryFailure:void 0,deleteVariableCostHistoryEntry:void 0,deleteVariableCostHistoryEntrySuccess:void 0,deleteVariableCostHistoryEntryFailure:void 0,updateVariableCostHistoryEntry:void 0,updateVariableCostHistoryEntrySuccess:void 0,updateVariableCostHistoryEntryFailure:void 0}}),s={create:r.create,createSuccess:r.createSuccess,createFailure:r.createFailure,getMonth:r.getMonth,getMonthSuccess:r.getMonthSuccess,getMonthFailure:r.getMonthFailure,getCreatedMonths:r.getCreatedMonths,getCreatedMonthsSuccess:r.getCreatedMonthsSuccess,getCreatedMonthsFailure:r.getCreatedMonthsFailure,addRevenue:r.addRevenue,addRevenueSuccess:r.addRevenueSuccess,addRevenueFailure:r.addRevenueFailure,updateRevenue:r.updateRevenue,updateRevenueSuccess:r.updateRevenueSuccess,updateRevenueFailure:r.updateRevenueFailure,deleteRevenue:r.deleteRevenue,deleteRevenueSuccess:r.deleteRevenueSuccess,deleteRevenueFailure:r.deleteRevenueFailure,addFixedCost:r.addFixedCost,addFixedCostSuccess:r.addFixedCostSuccess,addFixedCostFailure:r.addFixedCostFailure,updateFixedCost:r.updateFixedCost,updateFixedCostSuccess:r.updateFixedCostSuccess,updateFixedCostFailure:r.updateFixedCostFailure,deleteFixedCost:r.deleteFixedCost,deleteFixedCostSuccess:r.deleteFixedCostSuccess,deleteFixedCostFailure:r.deleteFixedCostFailure,addVariableCost:r.addVariableCost,addVariableCostSuccess:r.addVariableCostSuccess,addVariableCostFailure:r.addVariableCostFailure,updateVariableCost:r.updateVariableCost,updateVariableCostSuccess:r.updateVariableCostSuccess,updateVariableCostFailure:r.updateVariableCostFailure,deleteVariableCost:r.deleteVariableCost,deleteVariableCostSuccess:r.deleteVariableCostSuccess,deleteVariableCostFailure:r.deleteVariableCostFailure,addVariableCostHistoryEntry:r.addVariableCostHistoryEntry,addVariableCostHistoryEntrySuccess:r.addVariableCostHistoryEntrySuccess,addVariableCostHistoryEntryFailure:r.addVariableCostHistoryEntryFailure,deleteVariableCostHistoryEntry:r.deleteVariableCostHistoryEntry,deleteVariableCostHistoryEntrySuccess:r.deleteVariableCostHistoryEntrySuccess,deleteVariableCostHistoryEntryFailure:r.deleteVariableCostHistoryEntryFailure,updateVariableCostHistoryEntry:r.updateVariableCostHistoryEntry,updateVariableCostHistoryEntrySuccess:r.updateVariableCostHistoryEntrySuccess,updateVariableCostHistoryEntryFailure:r.updateVariableCostHistoryEntryFailure};var m=class n{createMonth(e){return l(c.rpc("create_monthly_snapshot",{p_month:e}))}getCreatedMonths(){return l(c.from("monthly_snapshots").select("month")).pipe(p(e=>e.data?.map(t=>t.month)??[]))}getMonth(e){return l(c.from("monthly_snapshots").select("*").eq("month",e).single()).pipe(p(t=>t.data))}addRevenue(e){return l(c.rpc("add_monthly_snapshot_revenue_line",{p_snapshot_id:e,p_line:{value:0,category:""}}).select("*").single()).pipe(p(t=>({revenue:t.data.retval_line,total:t.data.retval_revenue_total})))}updateRevenue(e,t){return l(c.rpc("update_monthly_snapshot_revenue_line",{p_snapshot_id:e,p_line_id:t.id.toString(),p_new_values:{value:t.value,category:t.category}}).select("*").single()).pipe(p(a=>({revenue:a.data.retval_revenue_lines,total:a.data.retval_revenue_total})))}deleteRevenue(e,t){return l(c.rpc("delete_monthly_snapshot_revenue_line",{p_snapshot_id:e,p_line_id:t.toString()}).select("*").single()).pipe(p(a=>({revenue:a.data.retval_revenue_lines,total:a.data.retval_revenue_total})))}addFixedCost(e){return l(c.rpc("add_monthly_snapshot_fixed_costs_line",{p_snapshot_id:e,p_line:{value:0,category:""}}).select("*").single()).pipe(p(t=>({fixedCost:t.data.retval_line,total:t.data.retval_fixed_costs_total})))}updateFixedCost(e,t){return l(c.rpc("update_monthly_snapshot_fixed_costs_line",{p_snapshot_id:e,p_line_id:t.id.toString(),p_new_values:{value:t.value,category:t.category}}).select("*").single()).pipe(p(a=>({fixedCosts:a.data.retval_fixed_costs,total:a.data.retval_fixed_costs_total})))}deleteFixedCost(e,t){return l(c.rpc("delete_monthly_snapshot_fixed_costs_line",{p_snapshot_id:e,p_line_id:t.toString()}).select("*").single()).pipe(p(a=>({fixedCosts:a.data.retval_fixed_costs,total:a.data.retval_fixed_costs_total})))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=_({token:n,factory:n.\u0275fac})};var F=class n{addVariableCost(e){return l(c.rpc("add_monthly_snapshot_variable_costs_line",{p_snapshot_id:e,p_line:{value:0,category:"Neu",forecast:0,history:[]}}).select("*").single()).pipe(p(t=>({variableCost:t.data.retval_line,total:t.data.retval_variable_costs_total})))}updateVariableCost(e,t){return l(c.rpc("update_monthly_snapshot_variable_costs_line",{p_snapshot_id:e,p_line_id:t.id.toString(),p_new_values:{value:t.value,category:t.category,forecast:t.forecast}}).select("*").single()).pipe(p(a=>({variableCosts:a.data.out_variable_costs_lines,total:a.data.out_variable_costs_total})))}deleteVariableCost(e,t){return l(c.rpc("delete_monthly_snapshot_variable_costs_line",{p_snapshot_id:e,p_line_id:t.toString()}).select("*").single()).pipe(p(a=>({variableCosts:a.data.retval_variable_costs,total:a.data.retval_variable_costs_total})))}addVariableCostHistoryEntry(e,t){return l(c.rpc("add_variable_costs_history_entry",{p_snapshot_id:e,p_line_id:t}).select("*").single()).pipe(p(a=>({variableCosts:a.data.variable_costs_lines,total:a.data.variable_costs_total})))}updateVariableCostHistoryEntry(e,t,a){return l(c.rpc("update_variable_costs_history_entry",{p_snapshot_id:e,p_line_id:t,p_history_item:a}).select("*").single()).pipe(p(o=>({variableCosts:o.data.variable_costs_lines,total:o.data.variable_costs_total})))}deleteVariableCostHistoryEntry(e,t,a){return l(c.rpc("delete_monthly_snapshot_variable_costs_history_entry",{p_history_item_id:a,p_line_id:t,p_snapshot_id:e}).select("*").single()).pipe(p(o=>({variableCosts:o.data.out_variable_costs_lines,total:o.data.out_variable_costs_total})))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=_({token:n,factory:n.\u0275fac})};function N(n=g(m),e=g(F),t=g(E)){return{create$:t.on(s.create).pipe(C(({payload:a})=>n.createMonth(a).pipe(h({next:o=>s.createSuccess(o),error:o=>s.createFailure(o)})))),getCreatedMonths$:t.on(s.getCreatedMonths).pipe(C(()=>n.getCreatedMonths().pipe(h({next:a=>s.getCreatedMonthsSuccess(a),error:a=>s.getCreatedMonthsFailure(a)})))),getMonth$:t.on(s.getMonth).pipe(C(({payload:a})=>n.getMonth(a).pipe(h({next:o=>s.getMonthSuccess(o),error:o=>s.getMonthFailure(o)})))),addRevenue$:t.on(s.addRevenue).pipe(C(({payload:a})=>n.addRevenue(a).pipe(h({next:o=>s.addRevenueSuccess(o),error:o=>s.addRevenueFailure(o)})))),updateRevenue$:t.on(s.updateRevenue).pipe(C(({payload:{revenue:a,monthId:o}})=>n.updateRevenue(o,a).pipe(h({next:i=>s.updateRevenueSuccess(i),error:i=>s.updateRevenueFailure(i)})))),deleteRevenue$:t.on(s.deleteRevenue).pipe(C(({payload:{monthId:a,revenueId:o}})=>n.deleteRevenue(a,o).pipe(h({next:i=>s.deleteRevenueSuccess(i),error:i=>s.deleteRevenueFailure(i)})))),addFixedCost$:t.on(s.addFixedCost).pipe(C(({payload:a})=>n.addFixedCost(a).pipe(h({next:o=>s.addFixedCostSuccess(o),error:o=>s.addFixedCostFailure(o)})))),updateFixedCost$:t.on(s.updateFixedCost).pipe(C(({payload:{fixedCost:a,monthId:o}})=>n.updateFixedCost(o,a).pipe(h({next:i=>s.updateFixedCostSuccess(i),error:i=>s.updateFixedCostFailure(i)})))),deleteFixedCost$:t.on(s.deleteFixedCost).pipe(C(({payload:{monthId:a,fixedCostId:o}})=>n.deleteFixedCost(a,o).pipe(h({next:i=>s.deleteFixedCostSuccess(i),error:i=>s.deleteFixedCostFailure(i)})))),addVariableCost$:t.on(s.addVariableCost).pipe(C(({payload:a})=>e.addVariableCost(a).pipe(h({next:o=>s.addVariableCostSuccess(o),error:o=>s.addVariableCostFailure(o)})))),updateVariableCost$:t.on(s.updateVariableCost).pipe(C(({payload:{variableCost:a,monthId:o}})=>e.updateVariableCost(o,a).pipe(h({next:i=>s.updateVariableCostSuccess(i),error:i=>s.updateVariableCostFailure(i)})))),deleteVariableCost$:t.on(s.deleteVariableCost).pipe(C(({payload:{monthId:a,variableCostId:o}})=>e.deleteVariableCost(a,o).pipe(h({next:i=>s.deleteVariableCostSuccess(i),error:i=>s.deleteVariableCostFailure(i)})))),addVariableCostHistoryEntry$:t.on(s.addVariableCostHistoryEntry).pipe(C(({payload:{monthId:a,variableCostId:o}})=>e.addVariableCostHistoryEntry(a,o).pipe(h({next:i=>s.addVariableCostHistoryEntrySuccess(i),error:i=>s.addVariableCostHistoryEntryFailure(i)})))),deleteVariableCostHistoryEntry$:t.on(s.deleteVariableCostHistoryEntry).pipe(C(({payload:{monthId:a,variableCostId:o,entryId:i}})=>e.deleteVariableCostHistoryEntry(a,o,i).pipe(h({next:b=>s.deleteVariableCostHistoryEntrySuccess(b),error:b=>s.deleteVariableCostHistoryEntryFailure(b)})))),updateVariableCostHistoryEntry$:t.on(s.updateVariableCostHistoryEntry).pipe(C(({payload:{monthId:a,variableCostId:o,entry:i}})=>e.updateVariableCostHistoryEntry(a,o,i).pipe(h({next:b=>s.updateVariableCostHistoryEntrySuccess(b),error:b=>s.updateVariableCostHistoryEntryFailure(b)}))))}}var V=M(I("monthly-check"),f({month:null,createdMonths:[],createProcessStatus:"init",getMonthProcessStatus:"init",saveRevenueProcessStatus:"init",addRevenueProcessStatus:"init",deleteRevenueProcessStatus:"init",saveFixedCostProcessStatus:"init",addFixedCostProcessStatus:"init",deleteFixedCostProcessStatus:"init",saveVariableCostProcessStatus:"init",addVariableCostProcessStatus:"init",deleteVariableCostProcessStatus:"init",addHistoryEntryProcessStatus:"init"}),k(()=>N()),w(d(s.create,()=>({createProcessStatus:"pending"})),d(s.createSuccess,()=>({createProcessStatus:"success"})),d(s.createFailure,()=>({createProcessStatus:"error"})),d(s.getCreatedMonthsSuccess,({payload:n})=>({createdMonths:n})),d(s.getMonth,()=>({getMonthProcessStatus:"pending"})),d(s.getMonthSuccess,({payload:n})=>({month:n,getMonthProcessStatus:"success"})),d(s.getMonthFailure,()=>({getMonthProcessStatus:"error"})),d(s.updateRevenue,()=>({saveRevenueProcessStatus:"pending"})),d(s.addRevenueSuccess,({payload:{revenue:n,total:e}},{month:t})=>({addRevenueProcessStatus:"success",month:y(v({},t),{revenue_lines:[...t.revenue_lines,n],revenue_total:e})})),d(s.updateRevenueSuccess,s.deleteRevenueSuccess,({payload:{revenue:n,total:e}},{month:t})=>({saveRevenueProcessStatus:"success",month:y(v({},t),{revenue_lines:n,revenue_total:e})})),d(s.updateRevenueFailure,()=>({saveRevenueProcessStatus:"error"})),d(s.updateFixedCost,()=>({saveFixedCostProcessStatus:"pending"})),d(s.addFixedCostSuccess,({payload:{fixedCost:n,total:e}},{month:t})=>({addFixedCostProcessStatus:"success",month:y(v({},t),{fixed_costs_lines:[...t.fixed_costs_lines,n],fixed_costs_total:e})})),d(s.updateFixedCostSuccess,s.deleteFixedCostSuccess,({payload:{fixedCosts:n,total:e}},{month:t})=>({saveFixedCostProcessStatus:"success",month:y(v({},t),{fixed_costs_lines:n,fixed_costs_total:e})})),d(s.updateFixedCostFailure,()=>({saveFixedCostProcessStatus:"error"})),d(s.addVariableCostSuccess,({payload:{variableCost:n,total:e}},{month:t})=>({addFixedCostProcessStatus:"success",month:y(v({},t),{variable_costs_lines:[...t.variable_costs_lines,n],variable_costs_total:e})})),d(s.updateVariableCostSuccess,s.deleteVariableCostSuccess,s.addVariableCostHistoryEntrySuccess,s.deleteVariableCostHistoryEntrySuccess,s.updateVariableCostHistoryEntrySuccess,({payload:{variableCosts:n,total:e}},{month:t})=>({saveVariableCostProcessStatus:"success",month:y(v({},t),{variable_costs_lines:n,variable_costs_total:e})})),d(s.addVariableCostHistoryEntry,()=>({addHistoryEntryProcessStatus:"pending"})),d(s.addVariableCostHistoryEntrySuccess,()=>({addHistoryEntryProcessStatus:"success"})),d(s.updateVariableCostFailure,()=>({saveVariableCostProcessStatus:"error"}))));var x=O($());var S=class n{events=P(s);store=g(V);router=g(R);currentMonth=this.store.month;isMonthLoading=u(()=>this.store.getMonthProcessStatus()==="pending");isMonthLoaded=u(()=>this.store.getMonthProcessStatus()==="success");isSavingRevenue=u(()=>this.store.saveRevenueProcessStatus()==="pending");isRevenueAdded=u(()=>this.store.addRevenueProcessStatus()==="success");isSavingFixedCost=u(()=>this.store.saveFixedCostProcessStatus()==="pending");isFixedCostAdded=u(()=>this.store.addFixedCostProcessStatus()==="success");isSavingVariableCost=u(()=>this.store.saveVariableCostProcessStatus()==="pending");isVariableCostAdded=u(()=>this.store.addVariableCostProcessStatus()==="success");isHistoryEntryAdded=u(()=>this.store.addHistoryEntryProcessStatus()==="success");revenue=u(()=>this.currentMonth()?.revenue_lines??[]);totalRevenue=u(()=>this.currentMonth()?.revenue_total??0);fixedCosts=u(()=>this.currentMonth()?.fixed_costs_lines??[]);totalFixedCosts=u(()=>this.currentMonth()?.fixed_costs_total??0);variableCosts=u(()=>this.currentMonth()?.variable_costs_lines??[]);totalVariableCosts=u(()=>this.currentMonth()?.variable_costs_total??0);createdMonths=u(()=>this.store.createdMonths().map(e=>({month:e,translated:(0,x.default)(e).format("MMMM")})));createdYears=u(()=>Array.from(new Set(this.store.createdMonths().map(e=>(0,x.default)(e).format("YYYY")))));createMonth(e){this.events.create(e)}getCreatedMonths(){this.events.getCreatedMonths()}getMonth(e){this.events.getMonth(e)}addRevenue(){this.events.addRevenue(this.currentMonth().id)}updateRevenue(e){this.events.updateRevenue({revenue:e,monthId:this.currentMonth().id})}deleteRevenue(e){this.events.deleteRevenue({monthId:this.currentMonth().id,revenueId:e})}addFixedCost(){this.events.addFixedCost(this.currentMonth().id)}updateFixedCost(e){this.events.updateFixedCost({fixedCost:e,monthId:this.currentMonth().id})}deleteFixedCost(e){this.events.deleteFixedCost({monthId:this.currentMonth().id,fixedCostId:e})}addVariableCost(){this.events.addVariableCost(this.currentMonth().id)}updateVariableCost(e){this.events.updateVariableCost({variableCost:e,monthId:this.currentMonth().id})}deleteVariableCost(e){this.events.deleteVariableCost({monthId:this.currentMonth().id,variableCostId:e})}addHistoryEntry(e){this.events.addVariableCostHistoryEntry({variableCostId:e,monthId:this.currentMonth().id})}deleteHistoryEntry(e,t){this.events.deleteVariableCostHistoryEntry({monthId:this.currentMonth().id,variableCostId:e,entryId:t})}updateHistoryEntry(e,t){this.events.updateVariableCostHistoryEntry({monthId:this.currentMonth().id,variableCostId:e,entry:t})}navigateTo(e,t){if(e&&!t){this.router.navigate(["/monthly-check",e]);return}this.router.navigate(["/monthly-check",e,t])}static \u0275fac=function(t){return new(t||n)};static \u0275prov=_({token:n,factory:n.\u0275fac})};function me(){return[m,F,V,S]}export{S as a,me as b};
