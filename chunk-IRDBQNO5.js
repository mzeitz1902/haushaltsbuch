import{g as U,h,i as v,j as u,k as F,l as w,m as I,n as x,o as y,p as P,q as p,r as m}from"./chunk-YGY3DK22.js";import{E as c,S,ba as l,ha as g,ma as i,y as a}from"./chunk-MCAXJ275.js";var s=I({source:"Users",events:{getUser:void 0,getUserSuccess:void 0,getUserFailure:void 0,login:void 0,loginSuccess:void 0,loginFailure:void 0,logout:void 0,logoutSuccess:void 0,logoutFailure:void 0}}),e={getUser:s.getUser,getUserSuccess:s.getUserSuccess,getUserFailure:s.getUserFailure,login:s.login,loginSuccess:s.loginSuccess,loginFailure:s.loginFailure,logout:s.logout,logoutSuccess:s.logoutSuccess,logoutFailure:s.logoutFailure};var n=class o{getUser(){return a(p.auth.getUser()).pipe(c(({data:t})=>t.user??null),S(1))}login(t,r){return a(p.auth.signInWithPassword({email:t,password:r})).pipe(S(1))}logout(){return a(p.auth.signOut())}static \u0275fac=function(r){return new(r||o)};static \u0275prov=g({token:o,factory:o.\u0275fac})};function b(){let o=i(F),t=i(n);return{getUser$:o.on(e.getUser).pipe(l(()=>t.getUser().pipe(m({next:r=>e.getUserSuccess(r),error:r=>e.getUserFailure(r)})))),login$:o.on(e.login).pipe(l(({payload:{email:r,password:E}})=>t.login(r,E).pipe(m({next:()=>e.loginSuccess(),error:L=>e.loginFailure(L)})))),getUserOnLoginSuccess$:o.on(e.loginSuccess).pipe(c(()=>e.getUser())),logout$:o.on(e.logout).pipe(l(()=>t.logout().pipe(m({next:()=>e.logoutSuccess(),error:r=>e.logoutFailure(r)}))))}}var f=h(P("users"),v({user:null,loadProcessStatus:"init",isLoggedIn:!1}),x(()=>b()),y(u(e.getUserSuccess,({payload:o})=>({user:o??null,loadProcessStatus:"success",isLoggedIn:o!==null})),u(e.getUserFailure,()=>({loadProcessStatus:"error"})),u(e.loginSuccess,()=>({isLoggedIn:!0})),u(e.logoutSuccess,()=>({isLoggedIn:!1}))));var d=class o{dispatcher=i(w);store=i(f);user=this.store.user;isLoggedIn=this.store.isLoggedIn;loadProcessStatus$=U(this.store.loadProcessStatus);getUser(){this.dispatcher.dispatch(e.getUser())}login(t,r){this.dispatcher.dispatch(e.login({email:t,password:r}))}logout(){this.dispatcher.dispatch(e.logout())}static \u0275fac=function(r){return new(r||o)};static \u0275prov=g({token:o,factory:o.\u0275fac})};function se(){return[n,d,f]}export{d as a,se as b};
