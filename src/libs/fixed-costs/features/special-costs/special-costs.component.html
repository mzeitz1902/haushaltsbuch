<app-money-table-v2
  headerTitle="Sonderkosten"
  headerIcon="BanknoteArrowDown"
  [data]="specialCosts()"
  [total]="total()"
  [isLoading]="isLoading()"
  [isSaving]="false"
  [isAdded]="isAdded()"
  [col3Template]="dueInMonth"
  [hasSum]="false"
  (addRow)="add()"
  (updateRow)="addValue($event)"
  (deleteRow)="delete($event)"
/>

<ng-template #dueInMonth let-row>
  <div class="flex h-5 overflow-visible">
    @if (selectedRow() === row.id) {
      <ng-select
        class="w-2/3"
        bindLabel="label"
        [items]="months"
        [formControl]="dueInMonthControl"
        [clearable]="false"
        [multiple]="true"
        [appendTo]="'body'"
        (change)="addValue(row)"
        (remove)="removeValue(row, $event)"
        (close)="selectedRow.set(null)"
      />
    } @else {
      <app-icon
        icon="Info"
        class="block h-5 w-24 flex-auto pl-3"
        [mtxPopoverTriggerFor]="popover"
        (click)="selectRow(row.id, row.due_in_month)"
      />
      <mtx-popover #popover [position]="['above', 'before']">
        <span>{{ row.due_in_month | toMonth }}</span>
      </mtx-popover>
    }
  </div>
</ng-template>
