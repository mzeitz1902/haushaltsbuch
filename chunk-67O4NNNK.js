import{G as l,K as f,O as n,bc as x,cc as y,dc as u,ec as F,gc as C,hc as h,jc as b,kc as R,lc as D,m as p,mc as w,nc as m,oc as v,r as S,yb as i}from"./chunk-HHYIU33T.js";var P=class t{getFixedCosts(){return p(m.from("fixed_costs").select("*").order("id")).pipe(S(e=>e.data??null))}addFixedCost(e){return p(m.from("fixed_costs").insert(e).select("*").single()).pipe(S(s=>s.data))}updateFixedCost(e){return p(m.from("fixed_costs").update({category:e.category,value:e.value,due_in:e.due_in,due_in_month:e.due_in_month}).eq("id",e.id).select("*").single()).pipe(S(s=>s.data))}deleteFixedCost(e){return p(m.from("fixed_costs").delete().eq("id",e))}static \u0275fac=function(s){return new(s||t)};static \u0275prov=f({token:t,factory:t.\u0275fac})};var c=h({source:"Fixed Costs",events:{load:void 0,loadSuccess:void 0,add:void 0,addSuccess:void 0,addFailure:void 0,update:void 0,updateSuccess:void 0,updateFailure:void 0,delete:void 0,deleteSuccess:void 0,deleteFailure:void 0}}),a={load:c.load,loadSuccess:c.loadSuccess,add:c.add,addSuccess:c.addSuccess,addFailure:c.addFailure,update:c.update,updateSuccess:c.updateSuccess,updateFailure:c.updateFailure,delete:c.delete,deleteSuccess:c.deleteSuccess,deleteFailure:c.deleteFailure};function M(){let t=n(F),e=n(P);return{$load:t.on(a.load).pipe(l(()=>e.getFixedCosts().pipe(v({next:s=>a.loadSuccess(s),error:console.error})))),add$:t.on(a.add).pipe(l(({payload:s})=>e.addFixedCost(s).pipe(v({next:r=>a.addSuccess(r),error:r=>a.addFailure(r)})))),update$:t.on(a.update).pipe(l(({payload:s})=>e.updateFixedCost(s).pipe(v({next:r=>a.updateSuccess(r),error:r=>a.updateFailure(r)})))),delete$:t.on(a.delete).pipe(l(({payload:{id:s,dueIn:r,type:o}})=>e.deleteFixedCost(s).pipe(v({next:()=>a.deleteSuccess({id:s,dueIn:r,type:o}),error:N=>a.deleteFailure(N)}))))}}var A=x(D("fixed-costs",R()),y({fixedCosts:[],quarterlyCosts:[],specialCosts:[],budgets:[],loadProcessStatus:"init",saveProcessStatus:"init",addFixedProcessStatus:"init",addQuarterlyProcessStatus:"init",addSpecialProcessStatus:"init",addBudgetProcessStatus:"init"}),b(()=>M()),w(u(a.load,()=>({loadProcessStatus:"pending"})),u(a.loadSuccess,({payload:t},e)=>{if(!t)return e;let s=t.filter(o=>o.type==="Budget"),r=t.filter(o=>o.type!=="Budget");return{fixedCosts:r.filter(o=>o.due_in==="Alle")??[],quarterlyCosts:r.filter(o=>o.due_in==="Quartal")??[],specialCosts:r.filter(o=>o.due_in==="Sonder")??[],budgets:s??[],loadProcessStatus:"success"}}),u(a.add,({payload:{due_in:t,type:e}})=>{if(e==="Budget")return{addBudgetProcessStatus:"pending"};switch(t){case"Quartal":return{addQuarterlyProcessStatus:"pending"};case"Alle":return{addFixedProcessStatus:"pending"};case"Sonder":return{addSpecialProcessStatus:"pending"};default:return{}}}),u(a.addSuccess,({payload:t},e)=>t?t.type==="Budget"?{budgets:e.budgets.concat(t),addBudgetProcessStatus:"success"}:t.due_in==="Quartal"?{quarterlyCosts:e.quarterlyCosts.concat(t),addQuarterlyProcessStatus:"success"}:t.due_in==="Sonder"?{specialCosts:e.specialCosts.concat(t),addSpecialProcessStatus:"success"}:{fixedCosts:e.fixedCosts.concat(t),addFixedProcessStatus:"success"}:e),u(a.update,()=>({saveProcessStatus:"pending"})),u(a.updateSuccess,({payload:t},e)=>t?t.type==="Budget"?{budgets:e.budgets.map(s=>s.id===t.id?t:s),saveProcessStatus:"success"}:t.due_in==="Quartal"?{quarterlyCosts:e.quarterlyCosts.map(s=>s.id===t.id?t:s),saveProcessStatus:"success"}:t.due_in==="Sonder"?{specialCosts:e.specialCosts.map(s=>s.id===t.id?t:s),saveProcessStatus:"success"}:{fixedCosts:e.fixedCosts.map(s=>s.id===t.id?t:s),saveProcessStatus:"success"}:e),u(a.deleteSuccess,({payload:{id:t,dueIn:e,type:s}},r)=>{if(s==="Budget")return{budgets:r.budgets.filter(o=>o.id!==t)};switch(e){case"Quartal":return{quarterlyCosts:r.quarterlyCosts.filter(o=>o.id!==t)};case"Sonder":return{specialCosts:r.specialCosts.filter(o=>o.id!==t)};default:return{fixedCosts:r.fixedCosts.filter(o=>o.id!==t)}}})));var q=class t{dispatcher=n(C);store=n(A);loadProcessStatus=this.store.loadProcessStatus;saveProcessStatus=this.store.saveProcessStatus;addFixedProcessStatus=this.store.addFixedProcessStatus;addQuarterlyProcessStatus=this.store.addQuarterlyProcessStatus;addSpecialProcessStatus=this.store.addSpecialProcessStatus;fixedCosts=this.store.fixedCosts;quarterlyCosts=this.store.quarterlyCosts;specialCosts=this.store.specialCosts;budgets=this.store.budgets;isLoading=i(()=>this.loadProcessStatus()==="pending");isSaving=i(()=>this.saveProcessStatus()==="pending");isFixedAdded=i(()=>this.addFixedProcessStatus()==="success");isQuarterlyAdded=i(()=>this.addQuarterlyProcessStatus()==="success");isSpecialAdded=i(()=>this.addSpecialProcessStatus()==="success");totalFixedCosts=i(()=>this.store.fixedCosts().reduce((e,s)=>e+s.value,0));totalQuarterlyCosts=i(()=>this.quarterlyCosts().reduce((e,s)=>e+s.value,0));totalSpecialCosts=i(()=>this.specialCosts().reduce((e,s)=>e+s.value,0));totalBudgets=i(()=>this.budgets().reduce((e,s)=>e+s.value,0));loadFixedCosts(){this.dispatcher.dispatch(a.load())}add(e){this.dispatcher.dispatch(a.add(e))}update(e){this.dispatcher.dispatch(a.update(e))}delete(e,s,r){this.dispatcher.dispatch(a.delete({id:e,dueIn:s,type:r}))}static \u0275fac=function(s){return new(s||t)};static \u0275prov=f({token:t,factory:t.\u0275fac})};function ce(){return[P,q,A]}var d=h({source:"Revenue",events:{load:void 0,loadSuccess:void 0,add:void 0,addSuccess:void 0,addFailure:void 0,update:void 0,updateSuccess:void 0,updateFailure:void 0,delete:void 0,deleteSuccess:void 0,deleteFailure:void 0}});var g=class t{getRevenue(){return p(m.from("revenue").select("*").order("id")).pipe(S(e=>e.data??null))}addRevenue(e){return p(m.from("revenue").insert(e).select("*").single()).pipe(S(s=>s.data))}updateRevenue(e){return p(m.from("revenue").update({category:e.category,value:e.value}).eq("id",e.id).select("*").single()).pipe(S(s=>s.data))}deleteRevenue(e){return p(m.from("revenue").delete().eq("id",e))}static \u0275fac=function(s){return new(s||t)};static \u0275prov=f({token:t,factory:t.\u0275fac})};function k(){let t=n(F),e=n(g);return{$load:t.on(d.load).pipe(l(()=>e.getRevenue().pipe(v({next:s=>d.loadSuccess(s),error:console.error})))),add$:t.on(d.add).pipe(l(({payload:s})=>e.addRevenue(s).pipe(v({next:r=>d.addSuccess(r),error:r=>d.addFailure(r)})))),update$:t.on(d.update).pipe(l(({payload:s})=>e.updateRevenue(s).pipe(v({next:r=>d.updateSuccess(r),error:r=>d.updateFailure(r)})))),delete$:t.on(d.delete).pipe(l(({payload:s})=>e.deleteRevenue(s).pipe(v({next:()=>d.deleteSuccess(s),error:r=>d.deleteFailure(r)}))))}}var E=x(D("revenue",R()),y({revenue:new Array,loadProcessStatus:"init",saveProcessStatus:"init",addProcessStatus:"init"}),b(()=>k()),w(u(d.load,()=>({loadProcessStatus:"pending"})),u(d.loadSuccess,({payload:t})=>({revenue:t??[],loadProcessStatus:"success"})),u(d.add,()=>({addProcessStatus:"pending"})),u(d.addSuccess,({payload:t},e)=>({revenue:e.revenue.concat(t),addProcessStatus:"success"})),u(d.update,()=>({saveProcessStatus:"pending"})),u(d.updateSuccess,({payload:t},e)=>({revenue:e.revenue.map(s=>s.id===t.id?t:s),saveProcessStatus:"success"})),u(d.deleteSuccess,({payload:t},e)=>({revenue:e.revenue.filter(s=>s.id!==t)}))));var Q=class t{dispatcher=n(C);store=n(E);loadProcessStatus=this.store.loadProcessStatus;saveProcessStatus=this.store.saveProcessStatus;addProcessStatus=this.store.addProcessStatus;revenue=this.store.revenue;isLoading=i(()=>this.loadProcessStatus()==="pending");isSaving=i(()=>this.saveProcessStatus()==="pending");isAdded=i(()=>this.addProcessStatus()==="success");total=i(()=>this.store.revenue().reduce((e,s)=>e+s.value,0));loadRevenue(){this.dispatcher.dispatch(d.load())}addRevenue(e){this.dispatcher.dispatch(d.add(e))}updateRevenue(e){this.dispatcher.dispatch(d.update(e))}deleteRevenue(e){this.dispatcher.dispatch(d.delete(e))}static \u0275fac=function(s){return new(s||t)};static \u0275prov=f({token:t,factory:t.\u0275fac})};function $e(){return[g,Q,E]}export{q as a,ce as b,Q as c,$e as d};
