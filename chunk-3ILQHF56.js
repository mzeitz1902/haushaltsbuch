import{a as A}from"./chunk-VSHLP2X2.js";import{b as Re,c as He}from"./chunk-377ZNMYP.js";import{a as Le}from"./chunk-6RVPIDUK.js";import{A as v,Bd as Ee,Ca as he,Db as b,Ea as C,Eb as G,Fa as w,Ga as x,Ha as s,I as re,Ia as l,Ja as S,K as ae,Ka as B,La as K,M as $,O as m,Ob as be,Q as u,Qa as F,Qb as H,R as f,S as se,Sa as d,Sd as Me,Ta as ue,Td as De,Ua as p,V as le,Xd as Te,Yd as Ie,Z as D,Zc as Ce,a as W,ab as fe,ae as We,b as ne,bb as ye,cb as Q,d as je,db as ke,dd as we,de as Be,ea as a,eb as k,ed as g,ee as Fe,fd as Z,fe as O,gb as T,h as ie,hb as h,ib as X,jb as I,ka as ce,kb as _e,la as y,qa as me,ra as de,sb as _,tb as R,tc as ge,ua as pe,ub as Y,v as oe,vc as ve,w as M,ya as q,yd as xe,za as z,zb as U,zd as Se}from"./chunk-5T7LH7WM.js";var E=je(Le());function qe(o,i){}var Ae="_mat-bottom-sheet-enter",Oe="_mat-bottom-sheet-exit",ze=(()=>{class o extends Re{_breakpointSubscription;_animationsDisabled=Z();_animationState="void";_animationStateChanged=new le;_destroyed=!1;constructor(){super();let e=m(Ce);this._breakpointSubscription=e.observe([g.Medium,g.Large,g.XLarge]).subscribe(()=>{let t=this._elementRef.nativeElement.classList;t.toggle("mat-bottom-sheet-container-medium",e.isMatched(g.Medium)),t.toggle("mat-bottom-sheet-container-large",e.isMatched(g.Large)),t.toggle("mat-bottom-sheet-container-xlarge",e.isMatched(g.XLarge))})}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._animationsDisabled&&this._simulateAnimation(Ae))}exit(){this._destroyed||(this._elementRef.nativeElement.setAttribute("mat-exit",""),this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._animationsDisabled&&this._simulateAnimation(Oe))}ngOnDestroy(){super.ngOnDestroy(),this._breakpointSubscription.unsubscribe(),this._destroyed=!0}_simulateAnimation(e){this._ngZone.run(()=>{this._handleAnimationEvent(!0,e),setTimeout(()=>this._handleAnimationEvent(!1,e))})}_trapFocus(){super._trapFocus({preventScroll:!0})}_handleAnimationEvent(e,t){let n=t===Ae;(n||t===Oe)&&this._animationStateChanged.emit({toState:n?"visible":"hidden",phase:e?"start":"done"})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=y({type:o,selectors:[["mat-bottom-sheet-container"]],hostAttrs:["tabindex","-1",1,"mat-bottom-sheet-container"],hostVars:9,hostBindings:function(t,n){t&1&&d("animationstart",function(c){return n._handleAnimationEvent(!0,c.animationName)})("animationend",function(c){return n._handleAnimationEvent(!1,c.animationName)})("animationcancel",function(c){return n._handleAnimationEvent(!1,c.animationName)}),t&2&&(pe("role",n._config.role)("aria-modal",n._config.ariaModal)("aria-label",n._config.ariaLabel),k("mat-bottom-sheet-container-animations-enabled",!n._animationsDisabled)("mat-bottom-sheet-container-enter",n._animationState==="visible")("mat-bottom-sheet-container-exit",n._animationState==="hidden"))},features:[me],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,n){t&1&&de(0,qe,0,0,"ng-template",0)},dependencies:[Te],styles:[`@keyframes _mat-bottom-sheet-enter{from{transform:translateY(100%)}to{transform:none}}@keyframes _mat-bottom-sheet-exit{from{transform:none}to{transform:translateY(100%)}}.mat-bottom-sheet-container{box-shadow:0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12);padding:8px 16px;min-width:100vw;box-sizing:border-box;display:block;outline:0;max-height:80vh;overflow:auto;position:relative;background:var(--mat-bottom-sheet-container-background-color, var(--mat-sys-surface-container-low));color:var(--mat-bottom-sheet-container-text-color, var(--mat-sys-on-surface));font-family:var(--mat-bottom-sheet-container-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-bottom-sheet-container-text-size, var(--mat-sys-body-large-size));line-height:var(--mat-bottom-sheet-container-text-line-height, var(--mat-sys-body-large-line-height));font-weight:var(--mat-bottom-sheet-container-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-bottom-sheet-container-text-tracking, var(--mat-sys-body-large-tracking))}@media(forced-colors: active){.mat-bottom-sheet-container{outline:1px solid}}.mat-bottom-sheet-container-animations-enabled{transform:translateY(100%)}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-enter{animation:_mat-bottom-sheet-enter 195ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-bottom-sheet-container-animations-enabled.mat-bottom-sheet-container-exit{animation:_mat-bottom-sheet-exit 375ms cubic-bezier(0.4, 0, 1, 1) backwards}.mat-bottom-sheet-container-xlarge,.mat-bottom-sheet-container-large,.mat-bottom-sheet-container-medium{border-top-left-radius:var(--mat-bottom-sheet-container-shape, 28px);border-top-right-radius:var(--mat-bottom-sheet-container-shape, 28px)}.mat-bottom-sheet-container-medium{min-width:384px;max-width:calc(100vw - 128px)}.mat-bottom-sheet-container-large{min-width:512px;max-width:calc(100vw - 256px)}.mat-bottom-sheet-container-xlarge{min-width:576px;max-width:calc(100vw - 384px)}
`],encapsulation:2})}return o})(),ee=new $("MatBottomSheetData"),J=class{viewContainerRef;injector;panelClass;direction;data=null;hasBackdrop=!0;backdropClass;disableClose=!1;ariaLabel=null;ariaModal=!1;closeOnNavigation=!0;autoFocus="first-tabbable";restoreFocus=!0;scrollStrategy;height="";minHeight;maxHeight},N=class{_ref;get instance(){return this._ref.componentInstance}get componentRef(){return this._ref.componentRef}containerInstance;disableClose;_afterOpened=new ie;_result;_closeFallbackTimeout;constructor(i,e,t){this._ref=i,this.containerInstance=t,this.disableClose=e.disableClose,t._animationStateChanged.pipe(M(n=>n.phase==="done"&&n.toState==="visible"),v(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(M(n=>n.phase==="done"&&n.toState==="hidden"),v(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._ref.close(this._result)}),i.overlayRef.detachments().subscribe(()=>{this._ref.close(this._result)}),oe(this.backdropClick(),this.keydownEvents().pipe(M(n=>n.keyCode===27))).subscribe(n=>{!this.disableClose&&(n.type!=="keydown"||!we(n))&&(n.preventDefault(),this.dismiss())})}dismiss(i){this.containerInstance&&(this.containerInstance._animationStateChanged.pipe(M(e=>e.phase==="start"),v(1)).subscribe(()=>{this._closeFallbackTimeout=setTimeout(()=>this._ref.close(this._result),500),this._ref.overlayRef.detachBackdrop()}),this._result=i,this.containerInstance.exit(),this.containerInstance=null)}afterDismissed(){return this._ref.closed}afterOpened(){return this._afterOpened}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}},Ke=new $("mat-bottom-sheet-default-options"),Ne=(()=>{class o{_injector=m(se);_parentBottomSheet=m(o,{optional:!0,skipSelf:!0});_animationsDisabled=Z();_defaultOptions=m(Ke,{optional:!0});_bottomSheetRefAtThisLevel=null;_dialog=m(He);get _openedBottomSheetRef(){let e=this._parentBottomSheet;return e?e._openedBottomSheetRef:this._bottomSheetRefAtThisLevel}set _openedBottomSheetRef(e){this._parentBottomSheet?this._parentBottomSheet._openedBottomSheetRef=e:this._bottomSheetRefAtThisLevel=e}constructor(){}open(e,t){let n=W(W({},this._defaultOptions||new J),t),r;return this._dialog.open(e,ne(W({},n),{disableClose:!0,closeOnOverlayDetachments:!1,maxWidth:"100%",container:ze,scrollStrategy:n.scrollStrategy||Ie(this._injector),positionStrategy:We(this._injector).centerHorizontally().bottom("0"),disableAnimations:this._animationsDisabled,templateContext:()=>({bottomSheetRef:r}),providers:(c,tt,Pe)=>(r=new N(c,n,Pe),[{provide:N,useValue:r},{provide:ee,useValue:n.data}])})),r.afterDismissed().subscribe(()=>{this._openedBottomSheetRef===r&&(this._openedBottomSheetRef=null)}),this._openedBottomSheetRef?(this._openedBottomSheetRef.afterDismissed().subscribe(()=>r.containerInstance?.enter()),this._openedBottomSheetRef.dismiss()):r.containerInstance.enter(),this._openedBottomSheetRef=r,r}dismiss(e){this._openedBottomSheetRef&&this._openedBottomSheetRef.dismiss(e)}ngOnDestroy(){this._bottomSheetRefAtThisLevel&&this._bottomSheetRefAtThisLevel.dismiss()}static \u0275fac=function(t){return new(t||o)};static \u0275prov=ae({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Qe=["noteInput"],Xe=["valueInput"],Ye=(o,i)=>i.id;function Ue(o,i){if(o&1){let e=F();s(0,"div",8)(1,"span",9),d("click",function(){let n=u(e).$implicit,r=p();return f(r.edit(n,"note"))}),h(2),l(),s(3,"span",10),d("click",function(){let n=u(e).$implicit,r=p();return f(r.edit(n,"value"))}),h(4),_(5,"currency"),l(),s(6,"input",11,0),d("blur",function(){u(e);let n=p();return f(n.submitAndReset())})("keyup.enter",function(){u(e);let n=p();return f(n.submitAndReset())}),l(),q(),s(8,"input",12,1),d("blur",function(){u(e);let n=p();return f(n.submitAndReset())})("keyup.enter",function(){u(e);let n=p();return f(n.submitAndReset())}),l(),q(),s(10,"button",13),d("click",function(){let n=u(e).$implicit,r=p();return f(r.deleteEntry(n.id))}),l()()}if(o&2){let e=i.$implicit,t=i.$index,n=i.$count,r=p(),c="ml-2 my-2 p-4";k("border-b-gray-50",t!==n-1)("border-b",t!==n-1),a(),T(c),k("hidden",r.selectedEntry()===e.id),a(),I(" ",e.note," "),a(),T(c),k("hidden",r.selectedEntry()===e.id),a(),I(" ",R(5,26,e.value)," "),a(2),T(c),k("hidden",r.selectedEntry()!==e.id),z(r.form.note,"formField"),a(2),T(c),k("hidden",r.selectedEntry()!==e.id),z(r.form.value,"formField")}}function Ge(o,i){o&1&&(s(0,"div",6),h(1,"Noch keine Eintr\xE4ge vorhanden."),l())}var P=class o{facade=m(A);history=this.facade.currentHistory;data=m(ee);noteRef=G.required("noteInput");valueRef=G.required("valueInput");selectedEntry=D(null);formModel=D(this.initForm());form=Be(this.formModel,i=>{O(i.id),O(i.value),O(i.note)});constructor(){this.facade.setCurrentHistoryInformation(this.data.weeklyCheckId,this.data.shop)}deleteEntry(i){return this.facade.deleteHistoryEntry(i)}addEntry(){this.facade.addHistoryEntry()}edit(i,e){this.selectedEntry.set(i.id),this.formModel.set({id:i.id,value:i.value,note:i.note}),setTimeout(()=>{switch(e){case"note":this.noteRef().nativeElement.select();break;case"value":this.valueRef().nativeElement.select();break}})}submitAndReset(){this.form().valid()&&(this.facade.updateHistoryEntry(this.formModel()),this.selectedEntry.set(null),this.formModel.set(this.initForm()))}initForm(){return{id:null,value:null,note:null}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-weekly-history"]],viewQuery:function(e,t){e&1&&fe(t.noteRef,Qe,5)(t.valueRef,Xe,5),e&2&&ye(2)},decls:8,vars:1,consts:[["noteInput",""],["valueInput",""],[1,"flex","flex-col","gap-2","overflow-hidden","pb-2"],[1,"max-h-64","overflow-auto"],[1,"flex","w-full","flex-col","items-center","justify-center","**:text-white"],[1,"grid","w-full","grid-cols-[auto_6rem_min-content]","items-center","gap-2",3,"border-b-gray-50","border-b"],[1,"p-2"],["maffiButton","","icon","CirclePlus",1,"self-center",3,"click"],[1,"grid","w-full","grid-cols-[auto_6rem_min-content]","items-center","gap-2"],[3,"click"],[1,"!m-0","!my-0","w-full","text-right",3,"click"],[1,"w-full","rounded","border-1","border-blue-400","bg-gray-600","outline-none",3,"blur","keyup.enter","formField"],["type","number",1,"w-full","rounded","border-1","border-blue-400","bg-gray-600","text-right","outline-none",3,"blur","keyup.enter","formField"],["maffiButton","","icon","Trash",1,"mr-2",3,"click"]],template:function(e,t){e&1&&(s(0,"section",2)(1,"div",3)(2,"div",4),C(3,Ue,11,28,"div",5,Ye,!1,Ge,2,0,"div",6),l()(),s(6,"button",7),d("click",function(){return t.addEntry()}),h(7," Hinzuf\xFCgen "),l()()),e&2&&(a(3),w(t.history()))},dependencies:[xe,Fe,H],encapsulation:2})};var j=class o{bottomSheet=m(Ne);viewContainerRef=m(ce);weeklyCheckId=b.required();label=b.required();entry=b.required();shop=b.required();isOpened=D(!1);openBottomSheet(){this.isOpened.set(!0);let i={weeklyCheckId:this.weeklyCheckId(),shop:this.shop()};this.bottomSheet.open(P,{data:i,viewContainerRef:this.viewContainerRef}).afterDismissed().pipe(v(1),re(()=>this.isOpened.set(!1))).subscribe()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-weekly-check-shop"]],inputs:{weeklyCheckId:[1,"weeklyCheckId"],label:[1,"label"],entry:[1,"entry"],shop:[1,"shop"]},decls:6,vars:8,consts:[[1,"flex","cursor-pointer","flex-col","gap-1","rounded-lg","p-1","hover:bg-gray-600","focus:bg-gray-600",3,"click"]],template:function(e,t){e&1&&(B(0,"div",0),ue("click",function(){return t.openBottomSheet()}),B(1,"span"),h(2),K(),B(3,"span"),h(4),_(5,"currency"),K()()),e&2&&(k("bg-gray-600",t.isOpened())("bg-gray-700",!t.isOpened()),a(2),X(t.label()),a(2),X(R(5,6,t.entry().value)))},dependencies:[H],encapsulation:2})};function Ze(o,i){if(o&1&&S(0,"app-weekly-check-shop",9),o&2){let e=i.$implicit,t=p();x("weeklyCheckId",t.week().id)("label",e.label)("entry",e.entry)("shop",e.shop)}}var L=class o{week=b.required();entries=U(()=>{let i=this.week();return[{label:"Lidl",entry:i.lidl,shop:"lidl"},{label:"Drogerie",entry:i.drugstore,shop:"drugstore"},{label:"Edeka",entry:i.edeka,shop:"edeka"},{label:"Sonstige",entry:i.misc,shop:"misc"},{label:"Kaufland",entry:i.kaufland,shop:"kaufland"},{label:"Ausw\xE4rts",entry:i.away,shop:"away"}]});isExpanded=U(()=>{let i=this.week(),e=(0,E.default)();return(0,E.default)(i.dateFrom).isSame(e,"day")||(0,E.default)(i.dateTo).isSame(e,"day")||(0,E.default)(i.dateFrom).isBefore(e,"day")&&(0,E.default)(i.dateTo).isAfter(e,"day")});static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-week"]],inputs:{week:[1,"week"]},decls:17,vars:13,consts:[["accItem","cdkAccordionItem"],[3,"expanded"],[1,"flex","items-center","justify-between",3,"click"],[1,"flex","flex-col","gap-2"],[1,"font-semibold"],[1,"text-(length:--text-xs)","font-medium"],["size","small",1,"ml-1",3,"icon"],[1,"overflow-hidden","pt-4","transition-[max-height]","duration-300","ease-in-out"],[1,"grid","grid-cols-4","gap-2"],[3,"weeklyCheckId","label","entry","shop"]],template:function(e,t){if(e&1){let n=F();s(0,"mat-card")(1,"mat-card-content")(2,"cdk-accordion-item",1,0)(4,"header",2),d("click",function(){u(n);let c=Q(3);return f(c.toggle())}),s(5,"div",3)(6,"h2",4),h(7),l(),s(8,"h1",5),h(9),_(10,"date"),_(11,"date"),l()(),S(12,"app-icon",6),l(),s(13,"div",7)(14,"div",8),C(15,Ze,1,4,"app-weekly-check-shop",9,he),l()()()()()}if(e&2){let n=Q(3);a(2),x("expanded",t.isExpanded()),a(5),I("KW ",t.week().cw),a(2),_e(" ",Y(10,7,t.week().dateFrom,"dd.MM.")," - ",Y(11,10,t.week().dateTo,"dd.MM.")," "),a(3),x("icon",n.expanded?"ChevronUp":"ChevronDown"),a(),ke("max-height",n.expanded?"1000px":"0px"),a(2),w(t.entries())}},dependencies:[ge,ve,De,Se,j,be],encapsulation:2})};var Je=(o,i)=>i.id;function et(o,i){if(o&1&&S(0,"app-week",2),o&2){let e=i.$implicit;x("week",e)}}var Ve=class o{facade=m(A);weeklyChecks=this.facade.weeklyChecks;isLoading=this.facade.isLoading;constructor(){this.facade.loadWeeklyChecks()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=y({type:o,selectors:[["app-weekly-check"]],decls:4,vars:0,consts:[["title","Wochencheck"],[1,"container-max-sm","mt-2","flex","w-full","flex-col","items-center","gap-2","p-2","*:w-full","md:p-6"],[3,"week"]],template:function(e,t){e&1&&(S(0,"app-header",0),s(1,"cdk-accordion",1),C(2,et,1,1,"app-week",2,Je),l()),e&2&&(a(2),w(t.weeklyChecks()))},dependencies:[Ee,L,Me],encapsulation:2})};export{Ve as WeeklyCheckComponent};
