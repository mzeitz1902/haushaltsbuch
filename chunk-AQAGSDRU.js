import{$b as y,F as p,J as S,N as u,Xb as x,Yb as C,Zb as d,_b as F,ac as h,cc as g,dc as R,ec as b,fc as l,gc as m,l as c,q as v,ub as i}from"./chunk-7DKHPSUB.js";var f=class s{getFixedCosts(){return c(l.from("fixed_costs").select("*").order("id")).pipe(v(e=>e.data??null))}addFixedCost(e){return c(l.from("fixed_costs").insert(e).select("*").single()).pipe(v(t=>t.data))}updateFixedCost(e){return c(l.from("fixed_costs").update({category:e.category,value:e.value,due_in:e.due_in,due_in_month:e.due_in_month}).eq("id",e.id).select("*").single()).pipe(v(t=>t.data))}deleteFixedCost(e){return c(l.from("fixed_costs").delete().eq("id",e))}static \u0275fac=function(t){return new(t||s)};static \u0275prov=S({token:s,factory:s.\u0275fac})};var n=h({source:"Fixed Costs",events:{load:void 0,loadSuccess:void 0,add:void 0,addSuccess:void 0,addFailure:void 0,update:void 0,updateSuccess:void 0,updateFailure:void 0,delete:void 0,deleteSuccess:void 0,deleteFailure:void 0}}),r={load:n.load,loadSuccess:n.loadSuccess,add:n.add,addSuccess:n.addSuccess,addFailure:n.addFailure,update:n.update,updateSuccess:n.updateSuccess,updateFailure:n.updateFailure,delete:n.delete,deleteSuccess:n.deleteSuccess,deleteFailure:n.deleteFailure};function Q(){let s=u(F),e=u(f);return{$load:s.on(r.load).pipe(p(()=>e.getFixedCosts().pipe(m({next:t=>r.loadSuccess(t),error:console.error})))),add$:s.on(r.add).pipe(p(({payload:t})=>e.addFixedCost(t).pipe(m({next:a=>r.addSuccess(a),error:a=>r.addFailure(a)})))),update$:s.on(r.update).pipe(p(({payload:t})=>e.updateFixedCost(t).pipe(m({next:a=>r.updateSuccess(a),error:a=>r.updateFailure(a)})))),delete$:s.on(r.delete).pipe(p(({payload:{id:t,dueIn:a}})=>e.deleteFixedCost(t).pipe(m({next:()=>r.deleteSuccess({id:t,dueIn:a}),error:M=>r.deleteFailure(M)}))))}}var D=x(b("fixed-costs"),C({fixedCosts:[],quarterlyCosts:[],specialCosts:[],loadProcessStatus:"init",saveProcessStatus:"init",addFixedProcessStatus:"init",addQuarterlyProcessStatus:"init",addSpecialProcessStatus:"init"}),g(()=>Q()),R(d(r.load,()=>({loadProcessStatus:"pending"})),d(r.loadSuccess,({payload:s})=>({fixedCosts:s?.filter(e=>e.due_in==="Alle")??[],quarterlyCosts:s?.filter(e=>e.due_in==="Quartal")??[],specialCosts:s?.filter(e=>e.due_in==="Sonder")??[],loadProcessStatus:"success"})),d(r.add,({payload:{due_in:s}})=>{switch(s){case"Quartal":return{addQuarterlyProcessStatus:"pending"};case"Alle":return{addFixedProcessStatus:"pending"};case"Sonder":return{addSpecialProcessStatus:"pending"};default:return{}}}),d(r.addSuccess,({payload:s},e)=>s.due_in==="Quartal"?{quarterlyCosts:e.quarterlyCosts.concat(s),addQuarterlyProcessStatus:"success"}:s.due_in==="Sonder"?{specialCosts:e.specialCosts.concat(s),addSpecialProcessStatus:"success"}:{fixedCosts:e.fixedCosts.concat(s),addFixedProcessStatus:"success"}),d(r.update,()=>({saveProcessStatus:"pending"})),d(r.updateSuccess,({payload:s},e)=>s.due_in==="Quartal"?{quarterlyCosts:e.quarterlyCosts.map(t=>t.id===s.id?s:t),saveProcessStatus:"success"}:s.due_in==="Sonder"?{specialCosts:e.specialCosts.map(t=>t.id===s.id?s:t),saveProcessStatus:"success"}:{fixedCosts:e.fixedCosts.map(t=>t.id===s.id?s:t),saveProcessStatus:"success"}),d(r.deleteSuccess,({payload:{id:s,dueIn:e}},t)=>{switch(e){case"Quartal":return{quarterlyCosts:t.quarterlyCosts.filter(a=>a.id!==s)};case"Sonder":return{specialCosts:t.specialCosts.filter(a=>a.id!==s)};default:return{fixedCosts:t.fixedCosts.filter(a=>a.id!==s)}}})));var w=class s{dispatcher=u(y);store=u(D);loadProcessStatus=this.store.loadProcessStatus;saveProcessStatus=this.store.saveProcessStatus;addFixedProcessStatus=this.store.addFixedProcessStatus;addQuarterlyProcessStatus=this.store.addQuarterlyProcessStatus;addSpecialProcessStatus=this.store.addSpecialProcessStatus;fixedCosts=this.store.fixedCosts;quarterlyCosts=this.store.quarterlyCosts;specialCosts=this.store.specialCosts;isLoading=i(()=>this.loadProcessStatus()==="pending");isSaving=i(()=>this.saveProcessStatus()==="pending");isFixedAdded=i(()=>this.addFixedProcessStatus()==="success");isQuarterlyAdded=i(()=>this.addQuarterlyProcessStatus()==="success");isSpecialAdded=i(()=>this.addSpecialProcessStatus()==="success");totalFixedCosts=i(()=>this.store.fixedCosts().reduce((e,t)=>e+t.value,0));totalQuarterlyCosts=i(()=>this.quarterlyCosts().reduce((e,t)=>e+t.value,0));totalSpecialCosts=i(()=>this.specialCosts().reduce((e,t)=>e+t.value,0));loadFixedCosts(){this.dispatcher.dispatch(r.load())}add(e){this.dispatcher.dispatch(r.add(e))}update(e){this.dispatcher.dispatch(r.update(e))}delete(e,t){this.dispatcher.dispatch(r.delete({id:e,dueIn:t}))}static \u0275fac=function(t){return new(t||s)};static \u0275prov=S({token:s,factory:s.\u0275fac})};function ue(){return[f,w,D]}var o=h({source:"Revenue",events:{load:void 0,loadSuccess:void 0,add:void 0,addSuccess:void 0,addFailure:void 0,update:void 0,updateSuccess:void 0,updateFailure:void 0,delete:void 0,deleteSuccess:void 0,deleteFailure:void 0}});var P=class s{getRevenue(){return c(l.from("revenue").select("*").order("id")).pipe(v(e=>e.data??null))}addRevenue(e){return c(l.from("revenue").insert(e).select("*").single()).pipe(v(t=>t.data))}updateRevenue(e){return c(l.from("revenue").update({category:e.category,value:e.value}).eq("id",e.id).select("*").single()).pipe(v(t=>t.data))}deleteRevenue(e){return c(l.from("revenue").delete().eq("id",e))}static \u0275fac=function(t){return new(t||s)};static \u0275prov=S({token:s,factory:s.\u0275fac})};function I(){let s=u(F),e=u(P);return{$load:s.on(o.load).pipe(p(()=>e.getRevenue().pipe(m({next:t=>o.loadSuccess(t),error:console.error})))),add$:s.on(o.add).pipe(p(({payload:t})=>e.addRevenue(t).pipe(m({next:a=>o.addSuccess(a),error:a=>o.addFailure(a)})))),update$:s.on(o.update).pipe(p(({payload:t})=>e.updateRevenue(t).pipe(m({next:a=>o.updateSuccess(a),error:a=>o.updateFailure(a)})))),delete$:s.on(o.delete).pipe(p(({payload:t})=>e.deleteRevenue(t).pipe(m({next:()=>o.deleteSuccess(t),error:a=>o.deleteFailure(a)}))))}}var A=x(b("revenue"),C({revenue:new Array,loadProcessStatus:"init",saveProcessStatus:"init",addProcessStatus:"init"}),g(()=>I()),R(d(o.load,()=>({loadProcessStatus:"pending"})),d(o.loadSuccess,({payload:s})=>({revenue:s??[],loadProcessStatus:"success"})),d(o.add,()=>({addProcessStatus:"pending"})),d(o.addSuccess,({payload:s},e)=>({revenue:e.revenue.concat(s),addProcessStatus:"success"})),d(o.update,()=>({saveProcessStatus:"pending"})),d(o.updateSuccess,({payload:s},e)=>({revenue:e.revenue.map(t=>t.id===s.id?s:t),saveProcessStatus:"success"})),d(o.deleteSuccess,({payload:s},e)=>({revenue:e.revenue.filter(t=>t.id!==s)}))));var q=class s{dispatcher=u(y);store=u(A);loadProcessStatus=this.store.loadProcessStatus;saveProcessStatus=this.store.saveProcessStatus;addProcessStatus=this.store.addProcessStatus;revenue=this.store.revenue;isLoading=i(()=>this.loadProcessStatus()==="pending");isSaving=i(()=>this.saveProcessStatus()==="pending");isAdded=i(()=>this.addProcessStatus()==="success");total=i(()=>this.store.revenue().reduce((e,t)=>e+t.value,0));loadRevenue(){this.dispatcher.dispatch(o.load())}addRevenue(e){this.dispatcher.dispatch(o.add(e))}updateRevenue(e){this.dispatcher.dispatch(o.update(e))}deleteRevenue(e){this.dispatcher.dispatch(o.delete(e))}static \u0275fac=function(t){return new(t||s)};static \u0275prov=S({token:s,factory:s.\u0275fac})};function $e(){return[P,q,A]}export{w as a,ue as b,q as c,$e as d};
